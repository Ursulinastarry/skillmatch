import{a as N}from"./chunk-AO5FASYK.js";import{a as A}from"./chunk-M5CVDSU7.js";import{b as I,d as k,h as E,p as D,q as V}from"./chunk-KETG777E.js";import{b as O}from"./chunk-HFLO2JPX.js";import{c as w}from"./chunk-NZP4ZDRF.js";import{$ as f,Ba as u,Ga as x,Jb as M,Ka as U,Nb as S,O as C,Ra as v,T as _,Ua as o,Va as i,Xa as y,Ya as b,Za as c,_ as p,cb as l,gb as m,hb as g,ib as P,xa as d}from"./chunk-MZDTUXRP.js";var h=class n{constructor(e){this.http=e}apiUrl=`${N.apiUrl}/profiles`;httpOptions={withCredentials:!0};getUserProfiles(){return this.http.get(this.apiUrl)}getUserProfileById(e){return this.http.get(`${this.apiUrl}/${e}`)}getUserProfileByUserId(e){return this.http.get(`${this.apiUrl}/users/${e}`)}createUserProfile(e){return this.http.post(this.apiUrl,e)}updateUserProfile(e,t){return this.http.put(`${this.apiUrl}/${e}`,t)}deleteUserProfile(e){return this.http.delete(`${this.apiUrl}/${e}`)}static \u0275fac=function(t){return new(t||n)(_(w))};static \u0275prov=C({token:n,factory:n.\u0275fac,providedIn:"root"})};function L(n,e){if(n&1){let t=y();o(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"span",8),l(5,"Photo"),i()(),o(6,"button",9),l(7,"Upload"),i()(),o(8,"div",10)(9,"div",11)(10,"label",12),l(11,"Full Name"),i(),o(12,"input",13),P("ngModelChange",function(r){p(t);let a=c();return g(a.userProfile.full_name,r)||(a.userProfile.full_name=r),f(r)}),i()(),o(13,"div",11)(14,"label",14),l(15,"Phone"),i(),o(16,"input",15),P("ngModelChange",function(r){p(t);let a=c();return g(a.userProfile.phone,r)||(a.userProfile.phone=r),f(r)}),i()(),o(17,"div",11)(18,"label",16),l(19,"Location"),i(),o(20,"input",17),P("ngModelChange",function(r){p(t);let a=c();return g(a.userProfile.location,r)||(a.userProfile.location=r),f(r)}),i()()()(),o(21,"div",18)(22,"button",19),b("click",function(){p(t);let r=c();return f(r.saveProfile())}),l(23,"Save Profile"),i(),o(24,"button",20),b("click",function(){p(t);let r=c();return f(r.deleteProfile())}),l(25,"Delete Profile"),i()()()}if(n&2){let t=c();d(12),m("ngModel",t.userProfile.full_name),d(4),m("ngModel",t.userProfile.phone),d(4),m("ngModel",t.userProfile.location)}}function B(n,e){n&1&&(o(0,"div")(1,"p"),l(2,"Loading user profile..."),i()())}var W=class n{constructor(e,t,s){this.userProfilesService=e;this.authService=t;this.route=s}userProfile=null;ngOnInit(){console.log("[Component Debug] Component initialized"),this.authService.inspectCookies(),this.authService.user$.subscribe(e=>{console.log("[Component Debug] User state changed:",e?`User ID: ${e.id}`:"No user"),e?(console.log("[Component Debug] Loading profile for user:",e.id),this.loadUserProfile(e.id)):(console.log("[Component Debug] No user in state, checking auth status..."),this.authService.checkAuthStatus().subscribe({next:t=>{t?(console.log("[Component Debug] Auth check successful, loading profile for:",t.id),this.loadUserProfile(t.id)):console.error("[Component Debug] Auth check returned no user")},error:t=>{console.error("[Component Debug] Auth check failed with error:",t.message)}}))})}loadUserProfile(e){console.log("[Component Debug] Starting profile load for:",e),e?this.userProfilesService.getUserProfileByUserId(String(e)).subscribe(t=>this.userProfile=t,t=>console.error("Error fetching user profile",t)):console.error("No logged-in user ID found")}saveProfile(){this.userProfile&&this.userProfilesService.updateUserProfile(this.userProfile.id,this.userProfile).subscribe(e=>{this.userProfile=e,console.log("Profile saved successfully")},e=>console.error("Error saving profile",e))}deleteProfile(){this.userProfile&&this.userProfilesService.deleteUserProfile(this.userProfile.id).subscribe(()=>{this.userProfile=null,console.log("Profile deleted successfully")},e=>console.error("Error deleting profile",e))}static \u0275fac=function(t){return new(t||n)(u(h),u(A),u(O))};static \u0275cmp=x({type:n,selectors:[["app-create-update-profile"]],decls:6,vars:2,consts:[[1,"container"],[1,"header"],["class","profile-section",4,"ngIf"],[4,"ngIf"],[1,"profile-section"],[1,"user-info"],[1,"avatar-section"],[1,"avatar"],[1,"avatar-placeholder"],[1,"upload-btn"],[1,"form-content"],[1,"form-group"],["for","fullName"],["type","text","id","fullName","placeholder","Enter your full name",3,"ngModelChange","ngModel"],["for","phone"],["type","tel","id","phone","placeholder","Enter your phone number",3,"ngModelChange","ngModel"],["for","location"],["type","text","id","location","placeholder","City, Country",3,"ngModelChange","ngModel"],[1,"actions"],[1,"save-button",3,"click"],[1,"delete-button",3,"click"]],template:function(t,s){t&1&&(o(0,"div",0)(1,"div",1)(2,"h2"),l(3,"Profile"),i()(),U(4,L,26,3,"div",2)(5,B,3,0,"div",3),i()),t&2&&(d(4),v("ngIf",s.userProfile),d(),v("ngIf",!s.userProfile))},dependencies:[S,M,D,I,k,E,V],styles:[".container[_ngcontent-%COMP%]{padding:20px;border-radius:8px;background-color:#fff}.header[_ngcontent-%COMP%]{margin-bottom:20px}.profile-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.user-info[_ngcontent-%COMP%]{display:flex;gap:30px}.avatar-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:10px}.avatar[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;background-color:#f0f0f0;display:flex;align-items:center;justify-content:center;border:1px dashed #ccc}.avatar-placeholder[_ngcontent-%COMP%]{color:#888}.upload-btn[_ngcontent-%COMP%]{background-color:#d6a4a4;color:#fff;padding:5px 10px;border:none;border-radius:4px;cursor:pointer}.form-content[_ngcontent-%COMP%]{flex:1}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:500}input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:4px}.actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:20px;margin-top:20px}.save-button[_ngcontent-%COMP%], .delete-button[_ngcontent-%COMP%]{background-color:#d6a4a4;color:#fff;padding:8px 16px;border:none;border-radius:4px;cursor:pointer}"]})};export{W as CreateUpdateProfileComponent};
